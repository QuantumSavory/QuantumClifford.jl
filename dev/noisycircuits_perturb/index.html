<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Perturbative Expansions · QuantumClifford.jl</title><meta name="title" content="Perturbative Expansions · QuantumClifford.jl"/><meta property="og:title" content="Perturbative Expansions · QuantumClifford.jl"/><meta property="twitter:title" content="Perturbative Expansions · QuantumClifford.jl"/><meta name="description" content="Documentation for QuantumClifford.jl."/><meta property="og:description" content="Documentation for QuantumClifford.jl."/><meta property="twitter:description" content="Documentation for QuantumClifford.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">QuantumClifford.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">QuantumClifford.jl</a></li><li><span class="tocitem">Stabilizer Tableau Algebra</span><ul><li><a class="tocitem" href="../stab-algebra-manual/">Manual</a></li><li><a class="tocitem" href="../canonicalization/">Canonicalization</a></li><li><a class="tocitem" href="../mixed/">Mixed States</a></li><li><a class="tocitem" href="../graphs/">Graph States</a></li><li><a class="tocitem" href="../datastructures/">Datastructure Choice</a></li><li><a class="tocitem" href="../commonstates/">Useful States</a></li></ul></li><li><span class="tocitem">Circuit Simulation</span><ul><li><a class="tocitem" href="../noisycircuits/">Simulation of Noisy Circuits</a></li><li><a class="tocitem" href="../noisycircuits_mc/">Monte Carlo</a></li><li class="is-active"><a class="tocitem" href>Perturbative Expansions</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Purification-Circuit-Example"><span>Purification Circuit Example</span></a></li><li><a class="tocitem" href="#Symbolic-expansions"><span>Symbolic expansions</span></a></li><li><a class="tocitem" href="#Interface-for-custom-operations"><span>Interface for custom operations</span></a></li><li class="toplevel"><a class="tocitem" href="#Error-Correction-in-Perturbative-Expansion-Simulations"><span>Error Correction in Perturbative Expansion Simulations</span></a></li></ul></li><li><a class="tocitem" href="../ecc_example_sim/">ECC example</a></li><li><a class="tocitem" href="../noisycircuits_ops/">Circuit Operations</a></li><li><a class="tocitem" href="../noisycircuits_API/">API</a></li></ul></li><li><span class="tocitem">ECC compendium</span><ul><li><a class="tocitem" href="../ECC_evaluating/">Evaluating codes and decoders</a></li><li><a class="tocitem" href="../ECC_API/">API</a></li></ul></li><li><a class="tocitem" href="../allops/">All Gates</a></li><li><a class="tocitem" href="../plotting/">Visualizations</a></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../tutandpub/">Tutorials and Publications</a></li><li><a class="tocitem" href="../references/">Suggested Readings &amp; References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Circuit Simulation</a></li><li class="is-active"><a href>Perturbative Expansions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Perturbative Expansions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumSavory/QuantumClifford.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumSavory/QuantumClifford.jl/blob/master/docs/src/noisycircuits_perturb.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="noisycircuits_perturb"><a class="docs-heading-anchor" href="#noisycircuits_perturb">Perturbative expansions for simulating noisy Clifford circuits</a><a id="noisycircuits_perturb-1"></a><a class="docs-heading-anchor-permalink" href="#noisycircuits_perturb" title="Permalink"></a></h1><p>This module enables the simulation of noisy Clifford circuits through a perturbative expansion in the noise parameter (assuming the noise is small). Instead of simulating many Monte Carlo trajectories, only the leading order trajectories are exhaustively enumerated and simulated, supporting even obtaining symbolic expressions for figures of merit.</p><h1 id="Purification-Circuit-Example"><a class="docs-heading-anchor" href="#Purification-Circuit-Example">Purification Circuit Example</a><a id="Purification-Circuit-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Purification-Circuit-Example" title="Permalink"></a></h1><p>Here is an example of a purification circuit (the same circuit seen in the <a href="../noisycircuits_mc/#noisycircuits_mc">Monte Carlo example</a>)</p><pre><code class="language-julia hljs">good_bell_state = S&quot;XX
                    ZZ&quot;
canonicalize_rref!(good_bell_state)
initial_state = MixedDestabilizer(good_bell_state⊗good_bell_state)

g1 = sCNOT(1,3) # CNOT between qubit 1 and qubit 3 (both with Alice)
g2 = sCNOT(2,4) # CNOT between qubit 2 and qubit 4 (both with Bob)
m = BellMeasurement([sMX(3),sMX(4)]) # Bell measurement on qubit 3 and 4
v = VerifyOp(good_bell_state,[1,2]) # Verify that qubit 1 and 2 indeed form a good Bell pair
epsilon = 0.01 # The error rate
n = NoiseOpAll(UnbiasedUncorrelatedNoise(epsilon))

# This circuit performs a depolarization at rate `epsilon` to all qubits,
# then bilater CNOT operations
# then a Bell measurement
# followed by checking whether the final result indeed corresponds to the correct Bell pair.
circuit = [n,g1,g2,m,v]

petrajectories(initial_state, circuit)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{CircuitStatus, Float64} with 3 entries:
  failure:CircuitStatus(3)       =&gt; 0.0129373
  true_success:CircuitStatus(1)  =&gt; 0.967065
  false_success:CircuitStatus(2) =&gt; 0.019406</code></pre><p>For more examples, see the <a href="https://nbviewer.jupyter.org/github/QuantumSavory/QuantumClifford.jl/blob/master/docs/src/notebooks/Perturbative_Expansions_vs_Monte_Carlo_Simulations.ipynb">notebook comparing the Monte Carlo and Perturbative method</a> or this tutorial on <a href="https://github.com/QuantumSavory/QuantumClifford.jl/blob/master/docs/src/notebooks/Noisy_Circuits_Tutorial_with_Purification_Circuits.ipynb">entanglement purification</a>.</p><h2 id="Symbolic-expansions"><a class="docs-heading-anchor" href="#Symbolic-expansions">Symbolic expansions</a><a id="Symbolic-expansions-1"></a><a class="docs-heading-anchor-permalink" href="#Symbolic-expansions" title="Permalink"></a></h2><p>The perturbative expansion method works with symbolic variables as well. One can use any of the symbolic libraries available in Julia and simply plug symbolic parameters in lieu of numeric parameters. A detailed example is available as a <a href="https://nbviewer.jupyter.org/github/QuantumSavory/QuantumClifford.jl/blob/master/docs/src/notebooks/Symbolic_Perturbative_Expansions.ipynb">Jupyter notebook</a>.</p><h2 id="Interface-for-custom-operations"><a class="docs-heading-anchor" href="#Interface-for-custom-operations">Interface for custom operations</a><a id="Interface-for-custom-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Interface-for-custom-operations" title="Permalink"></a></h2><p>If you want to create a custom gate type (e.g. calling it <code>Operation</code>), you need to definite the following methods.</p><p><code>applyop_branches!(s::T, g::Operation; max_order=1)::Vector{Tuple{T,Symbol,Real,Int}}</code> where <code>T</code> is a tableaux type like <a href="../API/#QuantumClifford.Stabilizer"><code>Stabilizer</code></a> or a <a href="../API/#QuantumClifford.Register"><code>Register</code></a>. The <code>Symbol</code> is the status of the operation, the <code>Real</code> is the probability for that branch, and the <code>Int</code> is the order of that branch.</p><p>There is also <code>applynoise_branches!</code> which is convenient for use in <code>NoisyGate</code>, but you can also just make up your own noise operator simply by implementing <code>applyop_branches!</code> for it.</p><p>You can also consult the <a href="../noisycircuits_ops/#noisycircuits_ops">list of implemented operators</a>.</p><h1 id="Error-Correction-in-Perturbative-Expansion-Simulations"><a class="docs-heading-anchor" href="#Error-Correction-in-Perturbative-Expansion-Simulations">Error Correction in Perturbative Expansion Simulations</a><a id="Error-Correction-in-Perturbative-Expansion-Simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Correction-in-Perturbative-Expansion-Simulations" title="Permalink"></a></h1><p>Here is an example that demonstrates the simulation of a noisy quantum circuit using perturbative expansions, where error correction is incorporated through a <code>DecoderCorrectionGate</code>. After encoding the Steane code and introducing noise, the decoder correction gate applies the (hopefully) most likely correction based on the measured syndrome, leading to a noticeable improvement in the logical success rate. This illustrates how perturbative expansion methods can be combined with error-correcting circuits to study performance under noise.</p><p>Some of the relevant structures and functions used in this code are:</p><ul><li><a href="../API/#QuantumClifford.Register"><code>Register</code></a></li><li><a href="../ECC_API/#QuantumClifford.ECC.TableDecoder"><code>TableDecoder</code></a></li><li><a href="../ECC_API/#QuantumClifford.ECC.DecoderCorrectionGate"><code>DecoderCorrectionGate</code></a></li><li><a href="../API/#QuantumClifford.petrajectories-Tuple{Any, Any}"><code>petrajectories</code></a></li></ul><pre><code class="language-julia hljs">using QuantumClifford
using QuantumClifford.ECC: Steane7, parity_checks, naive_encoding_circuit, naive_syndrome_circuit, TableDecoder, DecoderCorrectionGate, code_n, code_s

code = parity_checks(Steane7()) #creates the stabilizer tableau for the Steane code
data = code_n(code)
checks = code_s(code)
qbits = data+checks
register = Register(one(MixedDestabilizer, qbits), checks) # A register with 13 qubits, 7 data qubits and 6 ancillas
decoder = TableDecoder(code) # creates a decoder based on the Steane code

noiseless_state = one(MixedDestabilizer, data)
encoding_circuit = naive_encoding_circuit(code) # circuit to encode a state in the Steane codespace
mctrajectory!(noiseless_state, encoding_circuit) # applies each gate in ecirc to noiseless_state
verify = VerifyOp(noiseless_state, 1:data) # prepare a &quot;tomographic&quot; verification operation, checking that the first 7 qubits of the register indeed form still the same code word

syndrome_circuit,_,_ = naive_syndrome_circuit(code) # the operations needed to extract the error syndrome
epsilon = 0.1
noise = NoiseOp(UnbiasedUncorrelatedNoise(epsilon), (1:data)) # an op that introduces noise into the circuit

circuit = vcat(encoding_circuit, noise, syndrome_circuit, verify)</code></pre><img src="94cebd05.png" alt="Example block output"/><p>we can run perturbative expansions with <a href="../API/#QuantumClifford.petrajectories-Tuple{Any, Any}"><code>petrajectories</code></a>.</p><pre><code class="language-julia hljs">pet = petrajectories(register, circuit; max_order=3)
pet</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{CircuitStatus, Float64} with 3 entries:
  failure:CircuitStatus(3)       =&gt; 0.0
  true_success:CircuitStatus(1)  =&gt; 0.478467
  false_success:CircuitStatus(2) =&gt; 0.518805</code></pre><p>We see that the <code>true_success</code> rate is pretty terrible. In order to improve this rate with the help of error correction, we can use the <a href="../ECC_API/#QuantumClifford.ECC.DecoderCorrectionGate"><code>DecoderCorrectionGate</code></a>:</p><pre><code class="language-julia hljs">correction_gate = DecoderCorrectionGate(decoder, 1:data, 1:checks) # takes in the decoder, data qubits and syndrome bits as an input and guesses the most probable error correcting Pauli Operation based on the recorded syndrome</code></pre><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAADWCAIAAAD941MjAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAA9dJREFUeAHdwaGxIksAheFfnACQSHDIdiC73ThCWFIggglhyABQE8ZtJG5CaDkSHG636lVRdc2IHvbWvjrfp9+/f+NImBKmhCnxt6WUcs584OvrK8bIZ8QPOBwOv379YpaUEn+D+AGr1SrGyD8lTAlTYtrpdHo+n1QqpeSc27al3jAMwPV6vd1uVNrv9yEE3sS0+/0+jiOVHo9HKYVZxnEEhmEopVBpu93yjZjW9z31UkoxRmZpmgboui7GyGeEKWFKmBKmhClhSpgSpoQpYUqYEqaEKWFKmBKmhClhSpgSpoQpYUqYEqaEKWFKmBKmhCkxbb1el1Kol3Nu25Z6l8sFSClR73w+Hw4H3sS0vu9frxeVjsdjCIFZmqYBuq4LIVBps9nwjZi22+2ot1gsVqsVsyyXSyCEEGPkM8KUMCVMCVPClDAlTAlTwpQwJUwJU8KUMCVMCVPClDAlTAlTwpQwJUwJU8KUMCVMCVNi2ul0ej6fVCql5JzbtqXeMAzA9Xq93W5U2u/3IQTexLT7/T6OI5Uej0cphVnGcQSGYSilUGm73fKNmNb3PfVSSjFGZmmaBui6LsbIZ4QpYUqYEqaEKWFKmBKmhClhSpgSpoQpYUqYEqaEKWFKmBKmhClhSpgSpoQpYUqYEqaEKTFtvV6XUqiXc27blnqXywVIKVHvfD4fDgfexLS+71+vF5WOx2MIgVmapgG6rgshUGmz2fCNmLbb7ai3WCxWqxWzLJdLIIQQY+QzwpQwJUwJU8KUMCVMCVPClDAlTAlTwpQwJUwJU8KUMCVMCVPClDAlTAlTwpQwJUwJU2La6XR6Pp9UKqXknNu2pd4wDMD1er3dblTa7/chBN7EtPv9Po4jlR6PRymFWcZxBIZhKKVQabvd8o2Y1vc99VJKMUZmaZoG6LouxshnhClhSpgSpoQpYUqYEqaEKWFKmBKmhClhSpgSpoQpYUqYEqaEKWFKmBKmhClhSpgSpoQpMW29XpdSqJdzbtuWepfLBUgpUe98Ph8OB97EtL7vX68XlY7HYwiBWZqmAbquCyFQabPZ8I2YttvtqLdYLFarFbMsl0sghBBj5DPClDAlTAlTwpQwJUwJU8KUMCVMCVPClDAlTAlTwpQwJUwJU8KUMCVMCVPClDAlTAlTYtrpdHo+n1QqpeSc27al3jAMwPV6vd1uVNrv9yEE3sS0+/0+jiOVHo9HKYVZxnEEhmEopVBpu93yjZjW9z31UkoxRmZpmgboui7GyGeEKWFKmBKmhClhSpgSP6CUknPmnxI/4PIf/inxt319ffE/IEwJU8LUH29BGlmm3gFHAAAAAElFTkSuQmCC" alt="Example block output"/><p>Let&#39;s include the correction gate in our list of circuit operations and place it after syndrome collection.</p><pre><code class="language-julia hljs">circuit = vcat(encoding_circuit, noise, syndrome_circuit, correction_gate, verify)
pet = petrajectories(register, circuit; max_order=3)
pet</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{CircuitStatus, Float64} with 3 entries:
  failure:CircuitStatus(3)       =&gt; 0.0
  true_success:CircuitStatus(1)  =&gt; 0.867316
  false_success:CircuitStatus(2) =&gt; 0.129956</code></pre><p>We can see that the <code>true_success</code> rate has gone up significantly.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../noisycircuits_mc/">« Monte Carlo</a><a class="docs-footer-nextpage" href="../ecc_example_sim/">ECC example »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Sunday 26 October 2025 02:11">Sunday 26 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
